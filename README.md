# Mnemonic Sharding using Shamir's Secret Sharing Scheme

WARNING: Absolutely no guarantees are made about the security or accuracy of this code!

This program prompts the user to enter a mnemonic seed/secret which may represent a private key or seed.
Resulting shares are displayed in plaintext.  Always verify the shares are correct before using them!
Use *extreme* caution when using *any* program that deals with private keys/mnemonics!

If using this program to shard a private key, please ensure that the private key is stored securely and that the mnemonic seed/secret is never revealed to anyone!
It is recommended to use a secure, offline computer to perform this operation when providing mnemonics that are used in production or used to store cryptoassets.

## Prerequisites
On a fresh Ubuntu 22.04 install the following:
```
sudo apt install git gcc make m4
```

Install The GNU Multiple Precision Arithmetic Library (GMP) from [here](https://gmplib.org/).  The following is the tested version for Ubuntu 22.04:
```
wget https://gmplib.org/download/gmp/gmp-6.3.0.tar.xz
tar xvf gmp-6.3.0.tar.xz
cd gmp-6.3.0
./configure
make
make check
make install
```

## Setup
Clone the repository and run the following:
```
git clone https://github.com/danpaul000/mnemonic-sharder.git
cd mnemonic-sharder
```

Compile ssss.c to libssss.so
```
gcc -c -fPIC ssss.c -o ssss.o
gcc -shared -o libssss.so ssss.o -lgmp
```

## Testing
`test.py` is a unit test for the mnemonic sharder.  It will test the mnemonic sharder with a set of fixed secrets and a set of random secrets.
All tests should pass and use 24-word mnemonics.
```
python3 test.py
```

## Standard Usage
`python3 mnemonic_sharder.py --help`

Run the full flow (share creation, recombination and verification) of the mnemonic sharder.
You will be prompted to enter the full mnemonic seed/secret as well as the desired number of shares and the threshold number of shares needed for recombination.
New shares are generated and displayed in plaintext.  The `full` operation will also recombine the shares using two different sets of shares and display the results, confirming if the original secret was successfully recovered.  When securely storing shares after they are created, you must note the displayed "share index" for each share, as well as the resulting mnemonic value.  The share index is required to recombine the shares.
```
python3 mnemonic_sharder.py full
```

To create a new set of shares, run the `ssss-split` operation.  Resulting shares are displayed in plaintext as hex strings and mnemonics.
When securely storing shares after they are created, you must note the displayed "share index" for each share, as well as the resulting mnemonic value.  The share index is required to recombine the shares.
```
python3 mnemonic_sharder.py ssss-split
```

To recombine shares, run the `ssss-combine` operation.  The resulting secret is displayed in plaintext and should match the original mnemonic seed/secret.
```
python3 mnemonic_sharder.py ssss-combine
```

## Verification of Shares using Linux Binary `ssss-combine`
`ssss.c` in this repository is a C implementation of Shamir's Secret Sharing Scheme.  It is used to generate the shares.  It is forked from http://point-at-infinity.org/ssss/ and is licensed under the GPLv2.
You can use the [original ssss implementation](http://point-at-infinity.org/ssss/) to manually verify the shares generated by `mnemonic_sharder.py`.

1) Create a new set of shares
```
python3 mnemonic_sharder.py ssss-split
```

2) Condense the resulting mnemonic shares to the hex strings they represent.  Run the `condense` operation N times, where N is threshold number of shares needed for recombination.
Note the associated share index for each resulting hex string.
```
python3 mnemonic_sharder.py condense
```

3) Recombine the shares using the `ssss-combine` binary, providing `THRESHOLD` as the threshold number of shares needed for recombination, which was set during the previous split operation.
Provide the share index and the resulting hex string for each share.
```
ssss-combine -x -t [THRESHOLD]
```

4) Expand the resulting hex string back to original mnemonic seed/secret.
```
python3 mnemonic_sharder.py expand
```

# Disclaimer: Absolutely no guarantees are made about the security or accuracy of this code!
